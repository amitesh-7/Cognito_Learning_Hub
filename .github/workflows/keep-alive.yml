name: Keep Backend Services Alive

on:
  schedule:
    # Runs every 14 minutes
    - cron: '*/14 * * * *'
  workflow_dispatch: # Allow manual triggering

jobs:
  ping-services:
    runs-on: ubuntu-latest
    
    steps:
      - name: Ping Social Service
        run: |
          echo "Pinging Social Service..."
          curl -f -s -o /dev/null -w "Status: %{http_code} | Time: %{time_total}s\n" https://social-service-lwjy.onrender.com || echo "Failed to ping Social Service"
      
      - name: Ping Result Service
        run: |
          echo "Pinging Result Service..."
          curl -f -s -o /dev/null -w "Status: %{http_code} | Time: %{time_total}s\n" https://result-service-vwjh.onrender.com || echo "Failed to ping Result Service"
      
      - name: Ping Meeting Service
        run: |
          echo "Pinging Meeting Service..."
          curl -f -s -o /dev/null -w "Status: %{http_code} | Time: %{time_total}s\n" https://meeting-service-ogfj.onrender.com || echo "Failed to ping Meeting Service"
      
      - name: Ping Auth Service
        run: |
          echo "Pinging Auth Service..."
          curl -f -s -o /dev/null -w "Status: %{http_code} | Time: %{time_total}s\n" https://auth-service-uds0.onrender.com || echo "Failed to ping Auth Service"
      
      - name: Ping API Gateway
        run: |
          echo "Pinging API Gateway..."
          curl -f -s -o /dev/null -w "Status: %{http_code} | Time: %{time_total}s\n" https://api-gateway-kzo9.onrender.com || echo "Failed to ping API Gateway"
      
      - name: Ping Live Service
        run: |
          echo "Pinging Live Service..."
          curl -f -s -o /dev/null -w "Status: %{http_code} | Time: %{time_total}s\n" https://live-service-ga6w.onrender.com || echo "Failed to ping Live Service"
      
      - name: Ping Gamification Service
        run: |
          echo "Pinging Gamification Service..."
          curl -f -s -o /dev/null -w "Status: %{http_code} | Time: %{time_total}s\n" https://gamification-service-ax6n.onrender.com || echo "Failed to ping Gamification Service"
      
      - name: Ping Quiz Service
        run: |
          echo "Pinging Quiz Service..."
          curl -f -s -o /dev/null -w "Status: %{http_code} | Time: %{time_total}s\n" https://quiz-service-6jzt.onrender.com || echo "Failed to ping Quiz Service"
      
      - name: Ping Moderation Service
        run: |
          echo "Pinging Moderation Service..."
          curl -f -s -o /dev/null -w "Status: %{http_code} | Time: %{time_total}s\n" https://moderation-service-3e2e.onrender.com || echo "Failed to ping Moderation Service"
      
      - name: Summary
        run: |
          echo "âœ… All services pinged successfully!"
          echo "Next ping in 14 minutes..."
